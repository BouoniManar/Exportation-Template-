<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- Le titre est dynamique basé sur le restaurant chargé -->
    <title>{{ data.site.title | default("Restaurant") }}</title>
    <!-- Lien vers UN fichier CSS commun pour les deux restaurants -->
    <link rel="stylesheet" href="resto_style.css">
    <!-- Optionnel: Ajouter les polices spécifiques si nécessaire -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <!-- Charger les polices utilisées par les deux thèmes -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;700&family=Roboto:wght@400;500;700&family=Roboto+Slab:wght@400;700&family=Open+Sans:wght@400&display=swap" rel="stylesheet">

    <!-- Définition des variables CSS à partir du thème JSON du restaurant spécifique -->
    {% if data.theme %}
    <style id="theme-variables">
      :root {
        /* Polices (variables génériques, valeurs spécifiques au resto chargé) */
        --theme-font-primary: {{ data.theme.font | default('Roboto, sans-serif') | tojson | safe }};
        --theme-font-secondary: {{ data.theme.secondary_font | default('Open Sans, sans-serif') | tojson | safe }};
        --theme-font-heading: {{ data.theme.heading_font | default('Roboto Slab, serif') | tojson | safe }};

        /* Couleurs principales */
        --theme-primary-color: {{ data.theme.primary_color | default('#333') | tojson | safe }};
        --theme-secondary-color: {{ data.theme.secondary_color | default('#00A082') | tojson | safe }};
        --theme-accent-color: {{ data.theme.accent_color | default('#FFC900') | tojson | safe }};

        /* Fonds */
        --theme-bg-light: {{ data.theme.background_light | default('#f8f9fa') | tojson | safe }};
        --theme-bg-white: {{ data.theme.background_white | default('#ffffff') | tojson | safe }};

        /* Textes */
        --theme-text-dark: {{ data.theme.text_dark | default('#333333') | tojson | safe }};
        --theme-text-light: {{ data.theme.text_light | default('#ffffff') | tojson | safe }};
        --theme-text-medium: {{ data.theme.text_medium | default('#6c757d') | tojson | safe }};

        /* Bordures */
        --theme-border-color: {{ data.theme.border_color | default('#dee2e6') | tojson | safe }};

        /* Padding spécifique au layout */
        --main-content-padding-top: {{ data.main_content.style.padding_top | default('60px') | tojson | safe }};
      }
      body {
        font-family: var(--theme-font-primary); /* Police par défaut du resto chargé */
        background-color: var(--theme-bg-light);
        color: var(--theme-text-dark);
        margin: 0;
        padding: 0;
      }
      /* Appliquer la police des titres si définie */
      h1, h2, h3, h4, h5, h6 {
        font-family: var(--theme-font-heading);
      }
      .resto-main-content {
          padding-top: var(--main-content-padding-top);
      }
    </style>
    {% else %}
     <style> body { font-family: sans-serif; background-color: #f8f9fa;} </style>
    {% endif %}
</head>
<body>
    <!-- Importe les macros -->
    {% import 'resto_components.html' as components %}

    <!-- Rend le Header (qui peut inclure la navigation) -->
    {{ components.render_header(data.site, data.header, data.navigation) }}

    <!-- Contenu Principal : Conditionnel basé sur les clés présentes -->
    <main class="resto-main-content">

        {# --- Composants spécifiques à Chaneb --- #}
        {% if data.main_content.address_banner %}
            {{ components.render_address_banner(data.site, data.main_content.address_banner) }}
        {% endif %}
        {% if data.main_content.restaurant_info_banner %}
            {{ components.render_restaurant_info_banner(data.site, data.main_content.restaurant_info_banner) }}
        {% endif %}
        {% if data.main_content.menu_layout %}
            {{ components.render_menu_layout(data.site, data.main_content.menu_layout) }}
        {% endif %}

        {# --- Composants spécifiques à Cristallum --- #}
        {% if data.main_content.breadcrumb %}
            {{ components.render_breadcrumb(data.site, data.main_content.breadcrumb) }}
        {% endif %}
        {% if data.main_content.page_header %}
            {{ components.render_page_header(data.site, data.main_content.page_header) }}
        {% endif %}
        {% if data.main_content.gallery %}
            {{ components.render_gallery(data.site, data.main_content.gallery) }}
        {% endif %}
        {% if data.main_content.info_details %}
            {{ components.render_info_details(data.site, data.main_content.info_details) }}
        {% endif %}
        {% if data.main_content.address_details %}
            {{ components.render_address_details(data.site, data.main_content.address_details) }}
        {% endif %}
        {% if data.main_content.cta_add_photo %}
            {{ components.render_cta_add_photo(data.site, data.main_content.cta_add_photo) }}
        {% endif %}

    </main>

    <!-- Rend le Footer -->
    {{ components.render_footer(data.footer) }}

    <!-- JavaScript (Optionnel) -->
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script>
        $(document).ready(function(){
            console.log("Restaurant page '{{ data.site.title }}' loaded.");
            // Logique JS spécifique potentielle
            // Smooth scroll pour les ancres internes (utile pour Chaneb sidebar)
            $('.sidebar-nav a[href*="#"], .breadcrumb-link[href*="#"]').not('[href="#"]').not('[href="#0"]').click(function(event) {
                if ( location.pathname.replace(/^\//, '') == this.pathname.replace(/^\//, '') && location.hostname == this.hostname ) {
                    var target = $(this.hash);
                    target = target.length ? target : $('[name=' + this.hash.slice(1) + ']');
                    if (target.length) {
                        event.preventDefault();
                        var headerHeight = $('.resto-header').outerHeight() || 0;
                        // Prend aussi en compte la bannière adresse si elle existe et est fixe
                        var bannerHeight = $('.address-banner-fixed').outerHeight() || 0;
                        $('html, body').animate({
                            scrollTop: target.offset().top - headerHeight - bannerHeight
                        }, 800);
                    }
                }
            });

             // Toggle active class for sidebar (Example for Chaneb)
             $('.sidebar-nav a').on('click', function() {
                $('.sidebar-nav a').removeClass('active'); // Remove active from all
                $(this).addClass('active'); // Add active to clicked one
                // Note: Le smooth scroll ci-dessus gère le déplacement
             });
        });
    </script>
</body>
</html>